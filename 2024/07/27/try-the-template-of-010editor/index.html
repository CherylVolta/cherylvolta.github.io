
<!DOCTYPE html>
<html lang="zh-CN">
    <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  
    <link rel="icon" href="/img/favicon.ico">
  
  
      <meta name="author" content="Charlott2">
  
  
      <meta name="subtitle" content="不知壹乎生，小阁思常在。">
  
  
      <meta name="description" content="不知壹乎生，小阁思常在。">
  
  
      <meta name="keywords" content=",Blog, 个人博客, 技术博客, 生活博客">
  
  
    <link rel="alternate" href="/atom.xml " title="Family Of Charlotte" type="application/atom+xml">
  

  

  <title>浅尝 010 Editor 的模板编写 | Family Of Charlotte</title>

  

  

  

  <link rel="stylesheet" href="/css/style.css" >
  <link rel="stylesheet" href="/css/partial/dark.css" >

  
  
  

  
    
      <link rel="stylesheet" href="/css/partial/highlight/atom-one-light.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/css/iconfont.css">
    
  

  
    <script src="/js/todark.js"></script>
    
<meta name="generator" content="Hexo 7.2.0"></head>
</html>
    
<div class="nav index" style="height: 60px;">
    <div class="title animated fadeInDown">
        <div class="layui-container">
                <div class="nav-title"><a href="/" title="Family Of Charlotte">Family Of Charlotte</a></div>
            <div class="nav-list">
                <button> <span class=""></span><span style="display: block;"></span><span class=""></span> </button>
                <ul class="layui-nav" lay-filter="">
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/ ">
                            <i class=" fab fa-fort-awesome " style="color: rgb(255 107 107);"></i>
                            <span class="layui-nav-item-name">首页</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/archives/ ">
                            <i class=" fas fa-archive " style="color: rgb(10 189 227);"></i>
                            <span class="layui-nav-item-name">归档</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/tags/ ">
                            <i class=" fas fa-hashtag " style="color: rgb(254 202 87);"></i>
                            <span class="layui-nav-item-name">标签</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/categories/ ">
                            <i class=" far fa-folder-open " style="color: rgb(29 209 161);"></i>
                            <span class="layui-nav-item-name">分类</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/about/ ">
                            <i class=" fab fa-grav " style="color: rgb(154 106 247);"></i>
                            <span class="layui-nav-item-name">关于</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/guestbook/ ">
                            <i class=" fab fa-telegram " style="color: hsl(205deg 100% 50%);"></i>
                            <span class="layui-nav-item-name">留言</span>
                        </a>
                    </li>
                    
                    
                        <li class="layui-nav-item" id="btn-toggle-dark">🌙</li>
                    
                    <span class="layui-nav-bar" style="left: 342px; top: 78px; width: 0px; opacity: 0;"></span>
                </ul>
            </div>
        </div>
    </div>
</div>
    
<header class="header">
        
            <div class="logo">
                    <a href="/"><img src="https://avatars.githubusercontent.com/u/51262009" onerror=this.onerror=null,this.src="/img/loading.gif"></a>
            </div>
         
    </div>
     

            <div class="motto">
                <span>和明天说你好！OvO</span>
            </div>
    
    
            <div class="social">
                
                        <a class="social-icon" href="https://github.com/Charlott2" target="_blank" title="Github">
                            <i class="iconfont icon-GitHub" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="mailto:shabbyacc@outlook.com" target="_blank" title="Email">
                            <i class="iconfont icon-email" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="https://steamcommunity.com/id/the-most-handsome-man" target="_blank" title="Steam">
                            <i class="iconfont icon-steam" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="https://space.bilibili.com/552355730" target="_blank" title="Bilibili">
                            <i class="iconfont icon-bilibili" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="https://music.163.com/#/user/home?id=564549068" target="_blank" title="Netmusic">
                            <i class="iconfont icon-wangyiyunyinle1" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="/atom.xml" target="_blank" title="rss">
                            <i class="iconfont icon-rss" aria-hidden="true"></i>
                          </a>
                 
            </div>
     
</header>

    
<article id="post">
  <div class="post-title">浅尝 010 Editor 的模板编写</div>
  
<div class="post-meta">
    
    
      <div class="post-meta-item date">
        <span title="发表于 2024.07.27"><i class="far fa-calendar-alt"></i> 2024.07.27</span>
      </div>
      <div class="post-meta-item updated">
        <span title="更新于 2024.08.06"><i class="far fa-calendar-check"></i> 2024.08.06</span>
      </div>
     
    
      <div class="post-meta-item categories">
        
          <i class="fas fa-inbox article-meta__icon"></i> <a href="/categories/%E8%87%AA%E5%B7%B1%E6%8D%A3%E9%BC%93%E4%BA%9B/">自己捣鼓些</a>
        
          <i class="fas fa-inbox article-meta__icon"></i> <a href="/categories/%E8%87%AA%E5%B7%B1%E6%8D%A3%E9%BC%93%E4%BA%9B/010Editor/">010Editor</a>
        
      </div>
     
    
     <div class="post-meta-item wordcount">
        
          <i class="fas fa-pencil-alt"></i> <span class="post-count">6.2k 字</span>
           
        
          <i class="far fa-clock"></i> <span class="post-count">33 分钟</span>
                               
      </div>
     
</div>


  
    <div id="toc" class="toc">
          <h1>目录</h1>
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E5%9B%A0%E4%B8%8E%E7%BB%93%E6%9E%9C"><span class="toc-number">1.</span> <span class="toc-text">起因与结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#010-Editor-%E4%B9%8B%EF%BC%9A%E6%A8%A1%E6%9D%BF%E7%BB%93%E6%9E%9C"><span class="toc-number">2.</span> <span class="toc-text">010 Editor 之：模板结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#010-Editor-%E4%B9%8B%EF%BC%9A%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">010 Editor 之：模板语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#010-Editor-%E4%B9%8B%EF%BC%9A%E6%A8%A1%E6%9D%BF%E5%8F%98%E9%87%8F"><span class="toc-number">3.1.</span> <span class="toc-text">010 Editor 之：模板变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#010-Editor-%E4%B9%8B%EF%BC%9A%E5%BD%93%E5%89%8D%E5%9C%B0%E5%9D%80"><span class="toc-number">3.2.</span> <span class="toc-text">010 Editor 之：当前地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#010-Editor-%E4%B9%8B%EF%BC%9A%E5%85%B6%E5%AE%83"><span class="toc-number">3.3.</span> <span class="toc-text">010 Editor 之：其它</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%90%8E%E7%9A%84-CLASSAdv-%E6%A8%A1%E6%9D%BF%E6%BA%90%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">更新后的 CLASSAdv 模板源码</span></a></li></ol>
      </div>
    
  <div class="content">
        <div><h2 id="起因与结果"><a href="#起因与结果" class="headerlink" title="起因与结果"></a>起因与结果</h2><p>今天在学习 JVM 的 .class 字节码时，浅浅地用了用 010 Editor 工具，拿着它分析和查看字节码文件的结构，还用到了模板仓库中的 CLASSAdv 模板。由于模板比较老旧，遇到版本大于 53 的字节码时，就不能正确地识别对应的 Java 版本，故最终决定对 CLASSAdv 模板做一下修复和更新，浅尝一下 010 Editor 的模板编写。</p>
<p>更新已经提交到了 010 Editor 的官方模板仓库，搜索 CLASSAdv 模板并安装 1.3 版本即可。</p>
<h2 id="010-Editor-之：模板结果"><a href="#010-Editor-之：模板结果" class="headerlink" title="010 Editor 之：模板结果"></a>010 Editor 之：模板结果</h2><p>010 Editor 的模板可以很方便的从某类二进制文件中提取它的结构，模板文件以 .pt 为后缀，内容使用了类似 C 语言风格的 Binary Template Language 来编写，下图就是对 .class 字节码文件使用更新后的 CLASSAdv 模板的结果：</p>
<img src= "/img/loading.gif" data-src="/images/use-classadv-template-on-jvm-class.png" alt="Use CLASSAdv template on JVM class" style="zoom:33%;" />

<p>模板结果类似于文件系统中的目录结构，是一种树形结构，结构体可类比成文件夹，基本数据类型可以类比成文件。结果中的每一个元素（每一行）均由<strong>名称、值、起始地址、大小、类型、颜色、注释</strong>组成。</p>
<h2 id="010-Editor-之：模板语法"><a href="#010-Editor-之：模板语法" class="headerlink" title="010 Editor 之：模板语法"></a>010 Editor 之：模板语法</h2><p>Binary Template Language 的基础语法和代码风格基本等同于 C 语言，主要的差异有如下几点：</p>
<h3 id="010-Editor-之：模板变量"><a href="#010-Editor-之：模板变量" class="headerlink" title="010 Editor 之：模板变量"></a>010 Editor 之：模板变量</h3><ol>
<li><p>在模板中可以定义变量，语法为<code>变量类型 变量名</code>，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 该模板中定义了变量 a, b, c, d, e, f, g</span></span><br><span class="line"><span class="comment">// 枚举的变量类型为 “enum ENUM1 &#123; COMP_1 = 1, COMP_2 = 2, COMP_3 = 3 &#125;” 整体，结构体同理</span></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">float</span> b;</span><br><span class="line"><span class="type">double</span> c;</span><br><span class="line"><span class="built_in">string</span> d;</span><br><span class="line"><span class="type">int</span> e[<span class="number">4</span>];</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ENUM1</span> &#123;</span> COMP_1 = <span class="number">1</span>, COMP_2 = <span class="number">2</span>, COMP_3 = <span class="number">3</span> &#125; f;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">STRUCT1</span> &#123;</span> <span class="type">int</span> x; <span class="type">int</span> y; <span class="type">int</span> z; &#125; g;</span><br></pre></td></tr></table></figure>

<p>所有支持的变量类型详见：<a target="_blank" rel="noopener" href="https://www.sweetscape.com/010editor/manual/DataTypes.htm">官方数据类型文档</a></p>
</li>
<li><p>在模板中定义的变量将会自动关联到文件中的一段二进制序列，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行此模板后，将会创建一个 char 数组并关联到起始的 4 个字节，以及一个 int 变量并关联到接下来的 4 个字节</span></span><br><span class="line"><span class="comment">// 所谓的关联就是指把这些字节作为变量的值</span></span><br><span class="line"><span class="comment">// 关联多少字节取决于这个变量的类型（类型决定了大小）</span></span><br><span class="line"><span class="type">char</span> header[<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> numRecords;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在模板中定义的变量会显示到模板结果中，成为结果中的一行、多行（数组）或嵌套的行（结构体），而在结构体或函数中定义的变量，只有当结构体在模板中被定义或函数在模板中被调用时，才会显示到模板结果中，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 该变量是第一个变量，名称为 fileID，类型为 int</span></span><br><span class="line"><span class="comment">// int 类型的大小为 32 位二进制，表示为 4h</span></span><br><span class="line"><span class="comment">// 当前地址为初始值 0h</span></span><br><span class="line"><span class="comment">// 因此将前 32 bit 的数据，即地址为 0h ~ 4h（前包括，后不包括）的数据作为变量 fileID 的值</span></span><br><span class="line"><span class="comment">// 假设这段数据为 67 FF 53 01，则最终在模板结果中显示为：</span></span><br><span class="line"><span class="comment">// Name  		Value				Start		Size		Type		Color			Comment</span></span><br><span class="line"><span class="comment">// fileID		22282087		0h			4h			int								</span></span><br><span class="line"><span class="type">int</span> fileID; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 这一行定义了一个结构体类型 OPTION，此时不会在结果中显示</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OPTION</span> &#123;</span> <span class="type">int</span> tag; uint64 data; &#125;; </span><br><span class="line"><span class="comment">// 这一行定义了结构体变量 option，会依据子变量的定义创建子行</span></span><br><span class="line"><span class="comment">// 该变量是第二个变量，名称为 option，类型为 struct OPTION</span></span><br><span class="line"><span class="comment">// 结构体类型的大小取决于它里面的变量，本例中总计为 96 位二进制，表示为 Ch</span></span><br><span class="line"><span class="comment">// 第一个变量起始地址和大小为 0h、4h，则当前地址变为 0h + 4h = 4h</span></span><br><span class="line"><span class="comment">// 将接下来 32 位的数据，即地址为 4h ~ 8h 的数据作为子变量 tag 的值</span></span><br><span class="line"><span class="comment">// 将接下来 64 位的数据，即地址为 8h ~ 10h 的数据作为子变量 data 的值</span></span><br><span class="line"><span class="comment">// 假设这段数据分别为 66 66 46 40 和 00 02 00 00 18 02 00 00，则最终在模板结果中显示为（双击展开后）：</span></span><br><span class="line"><span class="comment">// Name  		Value								Start		Size		Type						Color			Comment</span></span><br><span class="line"><span class="comment">// option		        						4h			Ch			struct OPTION				</span></span><br><span class="line"><span class="comment">// 		tag		  1078355558 				4h			4h			int				</span></span><br><span class="line"><span class="comment">// 		data		2302102471168 		8h			8h			uint64				</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OPTION</span> <span class="title">option</span>;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>重复定义同名的变量将被视作定义一个数组变量，也可以通过循环语句和定义变量语句组合实现。如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法 1，显示为：</span></span><br><span class="line"><span class="comment">// Name		Value		Start		Size		Type		Color			Comment</span></span><br><span class="line"><span class="comment">// a[0]		...			0h			4h			int			</span></span><br><span class="line"><span class="comment">// a[1]		...			4h			4h			int		</span></span><br><span class="line"><span class="comment">// a[2]		...			8h			4h			int		</span></span><br><span class="line"><span class="type">int</span> a[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法 2，效果相同	</span></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法 3，效果相同</span></span><br><span class="line">local <span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 local 修饰的变量称为本地变量，不会自动关联二进制序列，也不会显示在模板结果中。本地变量主要用来做过程计算和作为循环索引</p>
</li>
<li><p>变量具有属性，可以在变量定义时设置，整体的语法为<code>变量类型 变量名 &lt;属性名=属性值&gt;</code>，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置变量 abc 关联的值在模板结果中展示时使用的格式，这里是十六进制 hex</span></span><br><span class="line"><span class="type">int</span> abc &lt;format=hex&gt;;</span><br></pre></td></tr></table></figure>

<p>常用的变量属性包括显示格式 format、背景颜色 bgcolor、前景颜色 fgcolor、样式 style、读取函数 read、注释函数 comment。所有支持的变量属性详见：<a target="_blank" rel="noopener" href="https://www.sweetscape.com/010editor/manual/TemplateVariables.htm">官方模板变量文档的“Special Attributes”小节</a></p>
</li>
<li><p>有些属性如 read、comment 接受的值是特定函数的函数名称，其大题用法如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下列代码基于 byte 类型定义了一个名为 MySize 的类型</span></span><br><span class="line"><span class="comment">// 使用该类型定义的变量，它的注释函数都会被设置为 SizeCommentFunc</span></span><br><span class="line"><span class="keyword">typedef</span> byte MySize &lt;comment=SizeCommentFunc&gt;;</span><br><span class="line"><span class="built_in">string</span> <span class="title function_">SizeCommentFunc</span><span class="params">( MySize &amp;s )</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>( s &lt; <span class="number">0</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Negative sizes not allowed.&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当一个 MySize 类型的变量被定义时，会自动关联下一个字节作为变量值，并在模板结果中显示</span></span><br><span class="line"><span class="comment">// 处理注释显示时，会将这个变量传递给注释函数，即 SizeCommentFunc 函数，并将返回值作为注释的内容</span></span><br><span class="line">MySize mySize;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 12.0 以上版本，010 Editor 支持了内联函数，此后 read、comment 等属性也支持了内联函数</span></span><br><span class="line"><span class="comment">// 形式 1：填写一个函数调用，并指定参数</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">float</span> Vec3f[<span class="number">3</span>] &lt;read=Str(<span class="string">&quot;&lt;%g %g %g&gt;&quot;</span>,this[<span class="number">0</span>],this[<span class="number">1</span>],this[<span class="number">2</span>])&gt;;</span><br><span class="line">Vec3f v1;</span><br><span class="line"><span class="comment">// 形式 2：填写一个内联函数，内联函数用一对小括号 () 包裹，其内可以是一个任意的表达式</span></span><br><span class="line">int64 c1 &lt;bgcolor=(this &lt; <span class="number">0</span> ? cRed : cNone )&gt;;</span><br><span class="line"><span class="comment">// 其中的 this 表示被设置属性的变量自己</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用如上两种形式优化 MySize 类型的定义</span></span><br><span class="line"><span class="keyword">typedef</span> byte MySize &lt;comment=(this &lt; <span class="number">0</span> ? <span class="string">&quot;Negative sizes not allowed.&quot;</span> : <span class="string">&quot;&quot;</span>)&gt;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>学过操作系统和计算机组成原理的我们知道，一个值在计算机中的存储方式分为小端方式和大端方式，我们读取这个值时也需要按照对应的方式。模板中通常在<strong>第一行</strong>会调用 <code>LittleEndian()</code> 或 <code>BigEndian()</code> 函数来显示指定小端方式或大端方式</p>
</li>
</ol>
<h3 id="010-Editor-之：当前地址"><a href="#010-Editor-之：当前地址" class="headerlink" title="010 Editor 之：当前地址"></a>010 Editor 之：当前地址</h3><ol>
<li><p>当前地址是下一个被定义变量的起始地址，初始为 0h，每定义一个变量，当前地址将会后移该变量的大小（通常用十六进制表示）</p>
</li>
<li><p><code>FTell()</code> 函数用于获取当前地址，<code>FSeek()</code> 函数用于修改当前地址，<code>FSkip()</code> 函数用于移动当前地址，使用这些函数的组合可以实现不按序读取数据。</p>
</li>
<li><p>使用 <code>ReadInt()</code>、<code>ReadByte()</code> 等读取函数配合 <code>FTell()</code> 等函数可以从当前地址开始读取一段符合类型的值，常在条件语句中用作判断，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从当前地址开始读取一段 int 值，且这个值为 1 时，将会定义结构体变量 opt1，类型为 OPTION1</span></span><br><span class="line"><span class="comment">// 否则将会定义结构体变量 opt2，类型为 OPTION2</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OPTION1</span> &#123;</span> <span class="type">int</span> tag; uchar data[<span class="number">8</span>]; &#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OPTION2</span> &#123;</span> <span class="type">int</span> tag; uint64 data; &#125;;</span><br><span class="line"><span class="keyword">if</span>( ReadInt( FTell() ) == <span class="number">1</span> )</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">OPTION1</span> <span class="title">opt1</span>;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">struct</span> OPTION2 opt2;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="010-Editor-之：其它"><a href="#010-Editor-之：其它" class="headerlink" title="010 Editor 之：其它"></a>010 Editor 之：其它</h3><ol>
<li><p>字符串需要与非字符串拼接时可以使用 <code>SPrintf()</code> 函数，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// str 的最终结果为 &quot;Hello 123&quot;</span></span><br><span class="line">local <span class="built_in">string</span> str;</span><br><span class="line">SPrintf(str, <span class="string">&quot;Hello %d&quot;</span>, <span class="number">123</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="更新后的-CLASSAdv-模板源码"><a href="#更新后的-CLASSAdv-模板源码" class="headerlink" title="更新后的 CLASSAdv 模板源码"></a>更新后的 CLASSAdv 模板源码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------------------------------------------------</span></span><br><span class="line"><span class="comment">//--- 010 Editor v5.0 Binary Template</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//      File: CLASSAdv.bt</span></span><br><span class="line"><span class="comment">//   Authors: Pishchik Ilya L. (RUS)</span></span><br><span class="line"><span class="comment">//   Version: 1.3</span></span><br><span class="line"><span class="comment">//   Purpose: A template for parsing Java Class (JVM) Files.</span></span><br><span class="line"><span class="comment">//            Includes visualizing bytecode.</span></span><br><span class="line"><span class="comment">//  Category: Programming</span></span><br><span class="line"><span class="comment">// File Mask: *.class</span></span><br><span class="line"><span class="comment">//  ID Bytes: CA FE BA BE</span></span><br><span class="line"><span class="comment">//   History:</span></span><br><span class="line"><span class="comment">//   1.3   2024-07-27 Charlott2: Future JDK version detection support; optimise the format of access flag detection results.</span></span><br><span class="line"><span class="comment">//   1.2   2017-02-22 Jupiter: JDK 1.8 and 1.9 detection; link to JVM Specification from Java SE 8 Edition.</span></span><br><span class="line"><span class="comment">//   1.1   2016-02-12 SweetScape Software: Updated header for repository submission.</span></span><br><span class="line"><span class="comment">//   1.0   Pishchik Ilya: Initial release.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// More info in The Java Virtual Machine Specification:</span></span><br><span class="line"><span class="comment">//   http://docs.oracle.com/javase/specs/jvms/se8/html/</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Current (JDK 1.9) version info defined in src/java.base/share/native/libjava/System.c:</span></span><br><span class="line"><span class="comment">// #define JAVA_MAX_SUPPORTED_VERSION 53</span></span><br><span class="line"><span class="comment">// #define JAVA_MAX_SUPPORTED_MINOR_VERSION 0</span></span><br><span class="line"><span class="comment">//------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">BigEndian();</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> ubyte u1;</span><br><span class="line"><span class="keyword">typedef</span> uint16 u2;</span><br><span class="line"><span class="keyword">typedef</span> uint32 u4;</span><br><span class="line"><span class="keyword">typedef</span> uint64 u8;</span><br><span class="line"><span class="keyword">typedef</span> byte i1;</span><br><span class="line"><span class="keyword">typedef</span> int16 i2;</span><br><span class="line"><span class="keyword">typedef</span> int32 i4;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Constant_pool</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> CONSTANT_Class=<span class="number">7</span>,</span><br><span class="line"> CONSTANT_Fieldref=<span class="number">9</span>,</span><br><span class="line"> CONSTANT_Methodref=<span class="number">10</span>,</span><br><span class="line"> CONSTANT_InterfaceMethodref=<span class="number">11</span>,</span><br><span class="line"> CONSTANT_String=<span class="number">8</span>,</span><br><span class="line"> CONSTANT_Integer=<span class="number">3</span>,</span><br><span class="line"> CONSTANT_Float=<span class="number">4</span>,</span><br><span class="line"> CONSTANT_Long=<span class="number">5</span>,</span><br><span class="line"> CONSTANT_Double=<span class="number">6</span>,</span><br><span class="line"> CONSTANT_NameAndType=<span class="number">12</span>,</span><br><span class="line"> CONSTANT_Utf8=<span class="number">1</span>,</span><br><span class="line"> CONSTANT_MethodHandle=<span class="number">15</span>,</span><br><span class="line"> CONSTANT_MethodType=<span class="number">16</span>,</span><br><span class="line"> CONSTANT_InvokeDynamic=<span class="number">18</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span>&lt;</span>u2&gt; access_property_flags</span><br><span class="line">&#123;</span><br><span class="line"> ACC_PUBLIC=<span class="number">0x0001</span>,</span><br><span class="line"> ACC_PRIVATE=<span class="number">0x0002</span>,</span><br><span class="line"> ACC_PROTECTED=<span class="number">0x0004</span>,</span><br><span class="line"> ACC_STATIC=<span class="number">0x0008</span>,</span><br><span class="line"> ACC_FINAL=<span class="number">0x0010</span>,</span><br><span class="line"> ACC_SUPER_ACC_SYNCHRONIZED=<span class="number">0x0020</span>,</span><br><span class="line"> ACC_BRIDGE_ACC_VOLATILE=<span class="number">0x0040</span>,</span><br><span class="line"> ACC_VARARGS_ACC_TRANSIENT=<span class="number">0x0080</span>,</span><br><span class="line"> ACC_NATIVE=<span class="number">0x0100</span>,</span><br><span class="line"> ACC_INTERFACE=<span class="number">0x0200</span>,</span><br><span class="line"> ACC_ABSTRACT=<span class="number">0x0400</span>,</span><br><span class="line"> ACC_STRICT=<span class="number">0x0800</span>,</span><br><span class="line"> ACC_SYNTHETIC=<span class="number">0x1000</span>,</span><br><span class="line"> ACC_ANNOTATION=<span class="number">0x2000</span>,</span><br><span class="line"> ACC_ENUM=<span class="number">0x4000</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">enum_type</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> Class,</span><br><span class="line"> Method,</span><br><span class="line"> Field,</span><br><span class="line"> Nested_Class</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> &lt;</span>u1&gt; enum_opcodes</span><br><span class="line">&#123;</span><br><span class="line">nop=<span class="number">0x00</span>,</span><br><span class="line">aconst_null=<span class="number">0x01</span>,</span><br><span class="line">iconst_m1=<span class="number">0x02</span>,</span><br><span class="line">iconst_0=<span class="number">0x03</span>,</span><br><span class="line">iconst_1=<span class="number">0x04</span>,</span><br><span class="line">iconst_2=<span class="number">0x05</span>,</span><br><span class="line">iconst_3=<span class="number">0x06</span>,</span><br><span class="line">iconst_4=<span class="number">0x07</span>,</span><br><span class="line">iconst_5=<span class="number">0x08</span>,</span><br><span class="line">lconst_0=<span class="number">0x09</span>,</span><br><span class="line">lconst_1=<span class="number">0x0a</span>,</span><br><span class="line">fconst_0=<span class="number">0x0b</span>,</span><br><span class="line">fconst_1=<span class="number">0x0c</span>,</span><br><span class="line">fconst_2=<span class="number">0x0d</span>,</span><br><span class="line">dconst_0=<span class="number">0x0e</span>,</span><br><span class="line">dconst_1=<span class="number">0x0f</span>,</span><br><span class="line">bipush=<span class="number">0x10</span>,</span><br><span class="line">sipush=<span class="number">0x11</span>,</span><br><span class="line">ldc=<span class="number">0x12</span>,</span><br><span class="line">ldc_w=<span class="number">0x13</span>,</span><br><span class="line">ldc2_w=<span class="number">0x14</span>,</span><br><span class="line">iload=<span class="number">0x15</span>,</span><br><span class="line">lload=<span class="number">0x16</span>,</span><br><span class="line">fload=<span class="number">0x17</span>,</span><br><span class="line">dload=<span class="number">0x18</span>,</span><br><span class="line">aload=<span class="number">0x19</span>,</span><br><span class="line">iload_0=<span class="number">0x1a</span>,</span><br><span class="line">iload_1=<span class="number">0x1b</span>,</span><br><span class="line">iload_2=<span class="number">0x1c</span>,</span><br><span class="line">iload_3=<span class="number">0x1d</span>,</span><br><span class="line">lload_0=<span class="number">0x1e</span>,</span><br><span class="line">lload_1=<span class="number">0x1f</span>,</span><br><span class="line">lload_2=<span class="number">0x20</span>,</span><br><span class="line">lload_3=<span class="number">0x21</span>,</span><br><span class="line">fload_0=<span class="number">0x22</span>,</span><br><span class="line">fload_1=<span class="number">0x23</span>,</span><br><span class="line">fload_2=<span class="number">0x24</span>,</span><br><span class="line">fload_3=<span class="number">0x25</span>,</span><br><span class="line">dload_0=<span class="number">0x26</span>,</span><br><span class="line">dload_1=<span class="number">0x27</span>,</span><br><span class="line">dload_2=<span class="number">0x28</span>,</span><br><span class="line">dload_3=<span class="number">0x29</span>,</span><br><span class="line">aload_0=<span class="number">0x2a</span>,</span><br><span class="line">aload_1=<span class="number">0x2b</span>,</span><br><span class="line">aload_2=<span class="number">0x2c</span>,</span><br><span class="line">aload_3=<span class="number">0x2d</span>,</span><br><span class="line">iaload=<span class="number">0x2e</span>,</span><br><span class="line">laload=<span class="number">0x2f</span>,</span><br><span class="line">faload=<span class="number">0x30</span>,</span><br><span class="line">daload=<span class="number">0x31</span>,</span><br><span class="line">aaload=<span class="number">0x32</span>,</span><br><span class="line">baload=<span class="number">0x33</span>,</span><br><span class="line">caload=<span class="number">0x34</span>,</span><br><span class="line">saload=<span class="number">0x35</span>,</span><br><span class="line">istore=<span class="number">0x36</span>,</span><br><span class="line">lstore=<span class="number">0x37</span>,</span><br><span class="line">fstore=<span class="number">0x38</span>,</span><br><span class="line">dstore=<span class="number">0x39</span>,</span><br><span class="line">astore=<span class="number">0x3a</span>,</span><br><span class="line">istore_0=<span class="number">0x3b</span>,</span><br><span class="line">istore_1=<span class="number">0x3c</span>,</span><br><span class="line">istore_2=<span class="number">0x3d</span>,</span><br><span class="line">istore_3=<span class="number">0x3e</span>,</span><br><span class="line">lstore_0=<span class="number">0x3f</span>,</span><br><span class="line">lstore_1=<span class="number">0x40</span>,</span><br><span class="line">lstore_2=<span class="number">0x41</span>,</span><br><span class="line">lstore_3=<span class="number">0x42</span>,</span><br><span class="line">fstore_0=<span class="number">0x43</span>,</span><br><span class="line">fstore_1=<span class="number">0x44</span>,</span><br><span class="line">fstore_2=<span class="number">0x45</span>,</span><br><span class="line">fstore_3=<span class="number">0x46</span>,</span><br><span class="line">dstore_0=<span class="number">0x47</span>,</span><br><span class="line">dstore_1=<span class="number">0x48</span>,</span><br><span class="line">dstore_2=<span class="number">0x49</span>,</span><br><span class="line">dstore_3=<span class="number">0x4a</span>,</span><br><span class="line">astore_0=<span class="number">0x4b</span>,</span><br><span class="line">astore_1=<span class="number">0x4c</span>,</span><br><span class="line">astore_2=<span class="number">0x4d</span>,</span><br><span class="line">astore_3=<span class="number">0x4e</span>,</span><br><span class="line">iastore=<span class="number">0x4f</span>,</span><br><span class="line">lastore=<span class="number">0x50</span>,</span><br><span class="line">fastore=<span class="number">0x51</span>,</span><br><span class="line">dastore=<span class="number">0x52</span>,</span><br><span class="line">aastore=<span class="number">0x53</span>,</span><br><span class="line">bastore=<span class="number">0x54</span>,</span><br><span class="line">castore=<span class="number">0x55</span>,</span><br><span class="line">sastore=<span class="number">0x56</span>,</span><br><span class="line">pop=<span class="number">0x57</span>,</span><br><span class="line">pop2=<span class="number">0x58</span>,</span><br><span class="line">dup=<span class="number">0x59</span>,</span><br><span class="line">dup_x1=<span class="number">0x5a</span>,</span><br><span class="line">dup_x2=<span class="number">0x5b</span>,</span><br><span class="line">dup2=<span class="number">0x5c</span>,</span><br><span class="line">dup2_x1=<span class="number">0x5d</span>,</span><br><span class="line">dup2_x2=<span class="number">0x5e</span>,</span><br><span class="line">swap=<span class="number">0x5f</span>,</span><br><span class="line">iadd=<span class="number">0x60</span>,</span><br><span class="line">ladd=<span class="number">0x61</span>,</span><br><span class="line">fadd=<span class="number">0x62</span>,</span><br><span class="line">dadd=<span class="number">0x63</span>,</span><br><span class="line">isub=<span class="number">0x64</span>,</span><br><span class="line">lsub=<span class="number">0x65</span>,</span><br><span class="line">fsub=<span class="number">0x66</span>,</span><br><span class="line">dsub=<span class="number">0x67</span>,</span><br><span class="line">imul=<span class="number">0x68</span>,</span><br><span class="line">lmul=<span class="number">0x69</span>,</span><br><span class="line">fmul=<span class="number">0x6a</span>,</span><br><span class="line">dmul=<span class="number">0x6b</span>,</span><br><span class="line">idiv=<span class="number">0x6c</span>,</span><br><span class="line">ldiv=<span class="number">0x6d</span>,</span><br><span class="line">fdiv=<span class="number">0x6e</span>,</span><br><span class="line">ddiv=<span class="number">0x6f</span>,</span><br><span class="line">irem=<span class="number">0x70</span>,</span><br><span class="line">lrem=<span class="number">0x71</span>,</span><br><span class="line">frem=<span class="number">0x72</span>,</span><br><span class="line">drem=<span class="number">0x73</span>,</span><br><span class="line">ineg=<span class="number">0x74</span>,</span><br><span class="line">lneg=<span class="number">0x75</span>,</span><br><span class="line">fneg=<span class="number">0x76</span>,</span><br><span class="line">dneg=<span class="number">0x77</span>,</span><br><span class="line">ishl=<span class="number">0x78</span>,</span><br><span class="line">lshl=<span class="number">0x79</span>,</span><br><span class="line">ishr=<span class="number">0x7a</span>,</span><br><span class="line">lshr=<span class="number">0x7b</span>,</span><br><span class="line">iushr=<span class="number">0x7c</span>,</span><br><span class="line">lushr=<span class="number">0x7d</span>,</span><br><span class="line">iand=<span class="number">0x7e</span>,</span><br><span class="line">land=<span class="number">0x7f</span>,</span><br><span class="line">ior=<span class="number">0x80</span>,</span><br><span class="line">lor=<span class="number">0x81</span>,</span><br><span class="line">ixor=<span class="number">0x82</span>,</span><br><span class="line">lxor=<span class="number">0x83</span>,</span><br><span class="line">iinc=<span class="number">0x84</span>,</span><br><span class="line">i2l=<span class="number">0x85</span>,</span><br><span class="line">i2f=<span class="number">0x86</span>,</span><br><span class="line">i2d=<span class="number">0x87</span>,</span><br><span class="line">l2i=<span class="number">0x88</span>,</span><br><span class="line">l2f=<span class="number">0x89</span>,</span><br><span class="line">l2d=<span class="number">0x8a</span>,</span><br><span class="line">f2i=<span class="number">0x8b</span>,</span><br><span class="line">f2l=<span class="number">0x8c</span>,</span><br><span class="line">f2d=<span class="number">0x8d</span>,</span><br><span class="line">d2i=<span class="number">0x8e</span>,</span><br><span class="line">d2l=<span class="number">0x8f</span>,</span><br><span class="line">d2f=<span class="number">0x90</span>,</span><br><span class="line">i2b=<span class="number">0x91</span>,</span><br><span class="line">i2c=<span class="number">0x92</span>,</span><br><span class="line">i2s=<span class="number">0x93</span>,</span><br><span class="line">lcmp=<span class="number">0x94</span>,</span><br><span class="line">fcmpl=<span class="number">0x95</span>,</span><br><span class="line">fcmpg=<span class="number">0x96</span>,</span><br><span class="line">dcmpl=<span class="number">0x97</span>,</span><br><span class="line">dcmpg=<span class="number">0x98</span>,</span><br><span class="line">ifeq=<span class="number">0x99</span>,</span><br><span class="line">ifne=<span class="number">0x9a</span>,</span><br><span class="line">iflt=<span class="number">0x9b</span>,</span><br><span class="line">ifge=<span class="number">0x9c</span>,</span><br><span class="line">ifgt=<span class="number">0x9d</span>,</span><br><span class="line">ifle=<span class="number">0x9e</span>,</span><br><span class="line">if_icmpeq=<span class="number">0x9f</span>,</span><br><span class="line">if_icmpne=<span class="number">0xa0</span>,</span><br><span class="line">if_icmplt=<span class="number">0xa1</span>,</span><br><span class="line">if_icmpge=<span class="number">0xa2</span>,</span><br><span class="line">if_icmpgt=<span class="number">0xa3</span>,</span><br><span class="line">if_icmple=<span class="number">0xa4</span>,</span><br><span class="line">if_acmpeq=<span class="number">0xa5</span>,</span><br><span class="line">if_acmpne=<span class="number">0xa6</span>,</span><br><span class="line"><span class="keyword">goto</span>=<span class="number">0xa7</span>,</span><br><span class="line">jsr=<span class="number">0xa8</span>,</span><br><span class="line">ret=<span class="number">0xa9</span>,</span><br><span class="line">tableswitch=<span class="number">0xaa</span>,</span><br><span class="line">lookupswitch=<span class="number">0xab</span>,</span><br><span class="line">ireturn=<span class="number">0xac</span>,</span><br><span class="line">lreturn=<span class="number">0xad</span>,</span><br><span class="line">freturn=<span class="number">0xae</span>,</span><br><span class="line">dreturn=<span class="number">0xaf</span>,</span><br><span class="line">areturn=<span class="number">0xb0</span>,</span><br><span class="line">Return=<span class="number">0xb1</span>,</span><br><span class="line">getstatic=<span class="number">0xb2</span>,</span><br><span class="line">putstatic=<span class="number">0xb3</span>,</span><br><span class="line">getfield=<span class="number">0xb4</span>,</span><br><span class="line">putfield=<span class="number">0xb5</span>,</span><br><span class="line">invokevirtual=<span class="number">0xb6</span>,</span><br><span class="line">invokespecial=<span class="number">0xb7</span>,</span><br><span class="line">invokestatic=<span class="number">0xb8</span>,</span><br><span class="line">invokeinterface=<span class="number">0xb9</span>,</span><br><span class="line">invokedynamic=<span class="number">0xba</span>,</span><br><span class="line">new=<span class="number">0xbb</span>,</span><br><span class="line">newarray=<span class="number">0xbc</span>,</span><br><span class="line">anewarray=<span class="number">0xbd</span>,</span><br><span class="line">arraylength=<span class="number">0xbe</span>,</span><br><span class="line">athrow=<span class="number">0xbf</span>,</span><br><span class="line">checkcast=<span class="number">0xc0</span>,</span><br><span class="line">instanceof=<span class="number">0xc1</span>,</span><br><span class="line">monitorenter=<span class="number">0xc2</span>,</span><br><span class="line">monitorexit=<span class="number">0xc3</span>,</span><br><span class="line">wide=<span class="number">0xc4</span>,</span><br><span class="line">multianewarray=<span class="number">0xc5</span>,</span><br><span class="line">ifnull=<span class="number">0xc6</span>,</span><br><span class="line">ifnonnull=<span class="number">0xc7</span>,</span><br><span class="line">goto_w=<span class="number">0xc8</span>,</span><br><span class="line">jsr_w=<span class="number">0xc9</span>,</span><br><span class="line">breakpoint=<span class="number">0xca</span>,</span><br><span class="line">impdep1=<span class="number">0xfe</span>,</span><br><span class="line">impdep2=<span class="number">0xff</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> &lt;</span>u1&gt; enum_array_type</span><br><span class="line">&#123;</span><br><span class="line">    no_body=<span class="number">0</span>,</span><br><span class="line">    index_body=<span class="number">1</span>,</span><br><span class="line">    index_const_body=<span class="number">2</span>,</span><br><span class="line">    sipush_body=<span class="number">3</span>,</span><br><span class="line">    bipush_body=<span class="number">4</span>, </span><br><span class="line">    newarray_body=<span class="number">5</span>,</span><br><span class="line">    indexbyte_1_2_body=<span class="number">6</span>,</span><br><span class="line">    branchbyte1_2_body=<span class="number">7</span>,</span><br><span class="line">    branchbyte1_4_body=<span class="number">8</span>, </span><br><span class="line">    invokeinterface_body=<span class="number">9</span>,</span><br><span class="line">    invokedynamic_body=<span class="number">10</span>,</span><br><span class="line">    multianewarray_body=<span class="number">11</span>,</span><br><span class="line">    wide_body=<span class="number">12</span>,</span><br><span class="line">    tableswitch_body=<span class="number">13</span>,</span><br><span class="line">    lookupswitch_body=<span class="number">14</span>,</span><br><span class="line">    index_v2_body=<span class="number">15</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> &lt;</span>u1&gt; enum_opcodes_body_type</span><br><span class="line">&#123;</span><br><span class="line"> T_BOOLEAN=<span class="number">4</span>,</span><br><span class="line"> T_CHAR=<span class="number">5</span>,</span><br><span class="line"> T_FLOAT=<span class="number">6</span>,</span><br><span class="line"> T_DOUBLE=<span class="number">7</span>,</span><br><span class="line"> T_BYTE=<span class="number">8</span>,</span><br><span class="line"> T_SHORT=<span class="number">9</span>,</span><br><span class="line"> T_INT=<span class="number">10</span>,</span><br><span class="line"> T_LONG=<span class="number">11</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> u4 address_constant_pool=<span class="number">0xA</span>;</span><br><span class="line"><span class="type">const</span> u4 address_constant_pool_count=<span class="number">0x8</span>;</span><br><span class="line"><span class="type">const</span> u2 constant_pool_count=ReadUShort(address_constant_pool_count)<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">local u8 map_address_constant_pool[constant_pool_count]&lt;format=hex&gt;;</span><br><span class="line">local u1 array_opcodes_body_type[<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[tableswitch]=tableswitch_body;<span class="comment">//170</span></span><br><span class="line">array_opcodes_body_type[lookupswitch]=lookupswitch_body;<span class="comment">//171</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[bipush]=bipush_body; <span class="comment">//16 +byte</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[iload]=index_body; <span class="comment">//21 +index</span></span><br><span class="line">array_opcodes_body_type[lload]=index_body; <span class="comment">//22 +index</span></span><br><span class="line">array_opcodes_body_type[fload]=index_body; <span class="comment">//23 +index</span></span><br><span class="line">array_opcodes_body_type[dload]=index_body; <span class="comment">//24 +index</span></span><br><span class="line">array_opcodes_body_type[aload]=index_body; <span class="comment">//25 +index</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[istore]=index_body;  <span class="comment">//54 +index</span></span><br><span class="line">array_opcodes_body_type[lstore]=index_body;  <span class="comment">//55 +index</span></span><br><span class="line">array_opcodes_body_type[fstore]=index_body; <span class="comment">//56 +index</span></span><br><span class="line">array_opcodes_body_type[dstore]=index_body; <span class="comment">//57 +index </span></span><br><span class="line">array_opcodes_body_type[astore]=index_body;  <span class="comment">//58 +index </span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[sipush]=sipush_body; <span class="comment">//17 +byte1,byte2</span></span><br><span class="line">array_opcodes_body_type[ldc]=index_v2_body; <span class="comment">//18 +index</span></span><br><span class="line">array_opcodes_body_type[ldc_w]=indexbyte_1_2_body; <span class="comment">//19 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[ldc2_w]=indexbyte_1_2_body;<span class="comment">//20 +indexbyte1,indexbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[iinc]=index_const_body; <span class="comment">//132 +index,const</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[ifeq]=branchbyte1_2_body; <span class="comment">//153 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[ifne]=branchbyte1_2_body; <span class="comment">//154 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[iflt]=branchbyte1_2_body; <span class="comment">//155 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[ifge]=branchbyte1_2_body; <span class="comment">//156 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[ifgt]=branchbyte1_2_body; <span class="comment">//157 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[ifle]=branchbyte1_2_body; <span class="comment">//158 +branchbyte1,branchbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[if_icmpeq]=branchbyte1_2_body; <span class="comment">//159 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[if_icmpne]=branchbyte1_2_body; <span class="comment">//160 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[if_icmplt]=branchbyte1_2_body; <span class="comment">//161 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[if_icmpge]=branchbyte1_2_body; <span class="comment">//162 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[if_icmpgt]=branchbyte1_2_body; <span class="comment">//163 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[if_icmple]=branchbyte1_2_body; <span class="comment">//164 +branchbyte1,branchbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[if_acmpeq]=branchbyte1_2_body; <span class="comment">//165 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[if_acmpne]=branchbyte1_2_body; <span class="comment">//166 +branchbyte1,branchbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[<span class="keyword">goto</span>]=branchbyte1_2_body; <span class="comment">//167 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[jsr]=branchbyte1_2_body; <span class="comment">//168 +branchbyte1,branchbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[ret]=index_body;<span class="comment">//169 +index</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[getstatic]=indexbyte_1_2_body; <span class="comment">//178 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[putstatic]=indexbyte_1_2_body; <span class="comment">//179 +indexbyte1,indexbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[getfield]=indexbyte_1_2_body; <span class="comment">//180 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[putfield]=indexbyte_1_2_body; <span class="comment">//181 +indexbyte1,indexbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[new]=indexbyte_1_2_body; <span class="comment">//187 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[newarray]=newarray_body; <span class="comment">//188 +atype</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[invokevirtual]=indexbyte_1_2_body; <span class="comment">//182 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[invokespecial]=indexbyte_1_2_body; <span class="comment">//183 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[invokestatic]=indexbyte_1_2_body; <span class="comment">//184 +indexbyte1,indexbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[anewarray]=indexbyte_1_2_body; <span class="comment">//189 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[checkcast]=indexbyte_1_2_body; <span class="comment">//192 +indexbyte1,indexbyte2</span></span><br><span class="line">array_opcodes_body_type[instanceof]=indexbyte_1_2_body; <span class="comment">//193 +indexbyte1,indexbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[wide]=wide_body; <span class="comment">//196 (iload,fload,aload,lload,dload,istore,fstore,astore,lstore,dstore,ret),indexbyte1,indexbyte2 or iinc,indexbyte1,indexbyte2,constbyte1,constbyte2</span></span><br><span class="line">array_opcodes_body_type[multianewarray]=multianewarray_body; <span class="comment">//197 indexbyte1,indexbyte2,dimensions</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[ifnull]=branchbyte1_2_body; <span class="comment">//198 +branchbyte1,branchbyte2</span></span><br><span class="line">array_opcodes_body_type[ifnonnull]=branchbyte1_2_body; <span class="comment">//199 +branchbyte1,branchbyte2</span></span><br><span class="line"></span><br><span class="line">array_opcodes_body_type[invokeinterface]=invokeinterface_body; <span class="comment">//185 +indexbyte1,indexbyte2,count,0</span></span><br><span class="line">array_opcodes_body_type[invokedynamic]=invokedynamic_body; <span class="comment">//186 +indexbyte1,indexbyte2,0,0</span></span><br><span class="line">array_opcodes_body_type[goto_w]=branchbyte1_4_body;<span class="comment">//200 +branchbyte1,branchbyte2,branchbyte3,branchbyte4</span></span><br><span class="line">array_opcodes_body_type[jsr_w]=branchbyte1_4_body; <span class="comment">//201 +branchbyte1,branchbyte2,branchbyte3,branchbyte4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+ConstantValue OK</span></span><br><span class="line"><span class="comment">+Code OK</span></span><br><span class="line"><span class="comment">+StackMapTable OK!</span></span><br><span class="line"><span class="comment">+Exceptions OK</span></span><br><span class="line"><span class="comment">+InnerClasses OK</span></span><br><span class="line"><span class="comment">+EnclosingMethod OK</span></span><br><span class="line"><span class="comment">+Synthetic OK</span></span><br><span class="line"><span class="comment">+Signature OK</span></span><br><span class="line"><span class="comment">+SourceFile OK</span></span><br><span class="line"><span class="comment">+SourceDebugExtension</span></span><br><span class="line"><span class="comment">+LineNumberTable OK</span></span><br><span class="line"><span class="comment">+LocalVariableTable OK</span></span><br><span class="line"><span class="comment">+LocalVariableTypeTable ?</span></span><br><span class="line"><span class="comment">+Deprecated OK</span></span><br><span class="line"><span class="comment">+RuntimeVisibleAnnotations OK</span></span><br><span class="line"><span class="comment">+RuntimeInvisibleAnnotations OK</span></span><br><span class="line"><span class="comment">+RuntimeVisibleParameterAnnotations OK</span></span><br><span class="line"><span class="comment">+RuntimeInvisibleParameterAnnotations OK</span></span><br><span class="line"><span class="comment">+AnnotationDefault OK</span></span><br><span class="line"><span class="comment">+BootstrapMethods*/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">element_value</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line"> u2 type_index;</span><br><span class="line"> u2 num_element_value_pairs;</span><br><span class="line"> <span class="keyword">if</span>(<span class="number">0</span>&lt;num_element_value_pairs)</span><br><span class="line"> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">   u2 element_name_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">   element_value value;</span><br><span class="line">  &#125;element_value_pairs[num_element_value_pairs]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">&#125;annotation&lt;comment=annotation_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line"> u1 tag;</span><br><span class="line">  <span class="keyword">if</span>(tag==<span class="string">&#x27;e&#x27;</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    u2 type_name_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">    u2 const_name_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">   &#125;enum_const_value&lt;comment=<span class="string">&quot;enum&quot;</span>&gt;;</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(tag==<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   u2 class_info_index;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(tag==<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   annotation annotation_value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(tag==<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">struct</span>&#123;   </span><br><span class="line">    u2 num_values;</span><br><span class="line">    element_value values[num_values]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">   &#125;array_value&lt;comment=<span class="string">&quot;array&quot;</span>&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">   <span class="comment">//B,C,D,F,I,J,S Z,or s. </span></span><br><span class="line">   u2 const_value_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;element_value&lt;comment=element_value_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    u1 tag; </span><br><span class="line">    <span class="comment">/*Top_variable_info  0</span></span><br><span class="line"><span class="comment">    Integer_variable_info 1</span></span><br><span class="line"><span class="comment">    Float_variable_info 2</span></span><br><span class="line"><span class="comment">    Double_variable_info 3</span></span><br><span class="line"><span class="comment">    Long_variable_info 4</span></span><br><span class="line"><span class="comment">    Null_variable_info 5</span></span><br><span class="line"><span class="comment">    UninitializedThis_variable_info 6*/</span></span><br><span class="line">    <span class="keyword">if</span>(tag==<span class="number">7</span>)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="comment">//Object_variable_info 7</span></span><br><span class="line">     u2 cpool_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tag==<span class="number">8</span>)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="comment">//Uninitialized_variable_info//Object_variable_info 7 8</span></span><br><span class="line">     u2 offset;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;verification_type_info;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">   u1 frame_type;<span class="comment">//same_frame</span></span><br><span class="line">   <span class="keyword">if</span>(frame_type&gt;=<span class="number">64</span>&amp;&amp;frame_type&lt;=<span class="number">127</span>)</span><br><span class="line">   &#123; </span><br><span class="line">     <span class="comment">//same_locals_1_stack_item_frame</span></span><br><span class="line">     verification_type_info <span class="built_in">stack</span>[<span class="number">1</span>]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(frame_type==<span class="number">247</span>)</span><br><span class="line">   &#123; </span><br><span class="line">    <span class="comment">//same_locals_1_stack_item_frame_extended</span></span><br><span class="line">    u2 offset_delta;</span><br><span class="line">    verification_type_info <span class="built_in">stack</span>[<span class="number">1</span>];</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(frame_type&gt;=<span class="number">248</span>&amp;&amp;frame_type&lt;=<span class="number">251</span>)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="comment">//chop_frame or same_frame_extended</span></span><br><span class="line">    u2 offset_delta;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(frame_type&gt;=<span class="number">252</span>&amp;&amp;frame_type&lt;=<span class="number">254</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="comment">//append_frame</span></span><br><span class="line">     u2 offset_delta;</span><br><span class="line">     verification_type_info locals[frame_type - <span class="number">251</span>]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(frame_type==<span class="number">255</span>)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="comment">//full_frame</span></span><br><span class="line">    u2 offset_delta;</span><br><span class="line">    u2 number_of_locals;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;number_of_locals)verification_type_info locals[number_of_locals]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    u2 number_of_stack_items;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;number_of_stack_items)verification_type_info <span class="built_in">stack</span>[number_of_stack_items]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;stack_map_frame&lt;comment=stack_map_frame_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">struct</span><span class="params">(<span class="type">int</span> hidden,u8 offsets)</span>&#123;</span><br><span class="line">   </span><br><span class="line"> <span class="keyword">if</span>(exists(hidden))</span><br><span class="line"> &#123;</span><br><span class="line">   u1 operation&lt;format=hex&gt;;</span><br><span class="line">   <span class="keyword">switch</span>(array_opcodes_body_type[operation]) </span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">case</span> index_body:</span><br><span class="line">    <span class="keyword">case</span> index_v2_body:</span><br><span class="line">     u1 index; </span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> index_const_body:</span><br><span class="line">     u1 index; </span><br><span class="line">     i1 _const&lt;name=<span class="string">&quot;const&quot;</span>&gt;;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> sipush_body:</span><br><span class="line">     u2 _byte&lt;name=<span class="string">&quot;byte&quot;</span>&gt;; <span class="comment">//byte1,byte2;</span></span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> bipush_body:</span><br><span class="line">     u1 _byte&lt;name=<span class="string">&quot;byte&quot;</span>&gt;;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> newarray_body:</span><br><span class="line">     u1 atype;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> multianewarray_body:</span><br><span class="line">        u2 indexbyte; <span class="comment">//indexbyte1,indexbyte2;</span></span><br><span class="line">        u1 dimensions;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> wide_body:</span><br><span class="line">        u1 operation2;</span><br><span class="line">        u2 indexbyte; <span class="comment">//indexbyte1,indexbyte2;</span></span><br><span class="line">        <span class="keyword">if</span>(operation2==iinc)</span><br><span class="line">        &#123;</span><br><span class="line">            u2 constbyte; <span class="comment">//constbyte1,constbyte2;</span></span><br><span class="line">        &#125;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> tableswitch_body:</span><br><span class="line">      local u4 len=<span class="number">4</span>-(offsets+<span class="number">1</span>)%<span class="number">4</span>;</span><br><span class="line">      <span class="keyword">if</span>(len&lt;<span class="number">4</span>) u1 byte_pad[len];</span><br><span class="line">      i4 defaultbyte; <span class="comment">//defaultbyte1,defaultbyte2,defaultbyte3,defaultbyte4</span></span><br><span class="line">      i4 lowbyte; <span class="comment">//lowbyte1,lowbyte2,lowbyte3,lowbyte4</span></span><br><span class="line">      i4 highbyte; <span class="comment">//highbyte1,highbyte2,highbyte3,highbyte4</span></span><br><span class="line">      u4 jump[highbyte-lowbyte+<span class="number">1</span>]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> lookupswitch_body:</span><br><span class="line">      local u4 len=<span class="number">4</span>-(offsets+<span class="number">1</span>)%<span class="number">4</span>;</span><br><span class="line">      <span class="keyword">if</span>(len&lt;<span class="number">4</span>)u1 byte_pad[len];</span><br><span class="line">      i4 defaultbyte; <span class="comment">//defaultbyte1,defaultbyte2,defaultbyte3,defaultbyte4</span></span><br><span class="line">      i4 npairs; <span class="comment">//npairs1,npairs2,npairs3,npairs4</span></span><br><span class="line">      <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">      &#123;</span></span><br><span class="line">        i4 match;</span><br><span class="line">        i4 offset;</span><br><span class="line">      &#125;match_offset[npairs];</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> indexbyte_1_2_body:</span><br><span class="line">      u2 indexbyte; <span class="comment">//indexbyte1,indexbyte2;</span></span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> branchbyte1_2_body:</span><br><span class="line">      i2 branchbyte; <span class="comment">//indexbyte1,indexbyte2;</span></span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> branchbyte1_4_body:</span><br><span class="line">      i4 branchbyte; <span class="comment">//branchbyte1,branchbyte2,branchbyte3,branchbyte4</span></span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> invokeinterface_body:</span><br><span class="line">      u2 indexbyte; <span class="comment">//indexbyte1,indexbyte2;</span></span><br><span class="line">      u1 _count&lt;name=<span class="string">&quot;const&quot;</span>&gt;;</span><br><span class="line">      u1 zero;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> invokedynamic_body:</span><br><span class="line">     u2 indexbyte; <span class="comment">//indexbyte1,indexbyte2;</span></span><br><span class="line">     u1 zero;</span><br><span class="line">     u1 zero;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;opcodes_operation&lt;comment=opcodes_operation_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">attribute_info</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line"> u2 attribute_name_index;</span><br><span class="line"> u4 attribute_length;</span><br><span class="line"></span><br><span class="line"> local <span class="built_in">string</span> attribute_name=get_constant_pool_Utf8(attribute_name_index);</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;ConstantValue&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">   u2 constantvalue_index &lt;comment=Name_OnComment&gt;;</span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;Code&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">    u2 max_stack;</span><br><span class="line">    u2 max_locals;</span><br><span class="line">    u4 code_length&lt;format=hex&gt;;</span><br><span class="line">    <span class="comment">//u1 code[code_length]&lt;format=hex&gt;;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">     local u8 begin_address=FTell();</span><br><span class="line">     local u8 current_address=FTell();</span><br><span class="line">     local u8 end_address=begin_address+code_length;</span><br><span class="line">     local u4 i;</span><br><span class="line">     local u8 Len;</span><br><span class="line">     <span class="keyword">while</span>( FTell() &lt; end_address)</span><br><span class="line">     &#123;  </span><br><span class="line">       opcodes_operation <span class="title function_">operation</span><span class="params">(<span class="number">0</span>,current_address-begin_address)</span>;</span><br><span class="line">       Len=FTell()-current_address<span class="number">-1</span>;</span><br><span class="line">       FSkip(-Len);</span><br><span class="line">       <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Len;i++)</span><br><span class="line">       &#123;</span><br><span class="line">         opcodes_operation <span class="title function_">operation</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span>&lt;size=<span class="number">1</span>,hidden=<span class="literal">true</span>&gt;;</span><br><span class="line">       &#125;</span><br><span class="line">       current_address=FTell();</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;code;</span><br><span class="line"></span><br><span class="line">    u2 exception_table_length;</span><br><span class="line">    <span class="keyword">if</span>(exception_table_length&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">     &#123;</span></span><br><span class="line">      u2 start_pc;</span><br><span class="line">      u2 end_pc;</span><br><span class="line">      u2 handler_pc;</span><br><span class="line">      u2 catch_type&lt;comment=Name_Exception_OnComment&gt;;</span><br><span class="line">     &#125;exception_table[exception_table_length]; </span><br><span class="line">    &#125;</span><br><span class="line">    u2 attributes_count;</span><br><span class="line">    <span class="keyword">if</span>(attributes_count&gt;<span class="number">0</span>)attribute_info attributes[attributes_count]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;Exceptions&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">    u2 number_of_exceptions;</span><br><span class="line">    u2 exception_index_table[number_of_exceptions]&lt;comment=Name_Exception_OnComment,optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;LineNumberTable&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">    u2 line_number_table_length;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span>&#123;</span>   </span><br><span class="line">      u2 start_pc;</span><br><span class="line">      u2 line_number;	</span><br><span class="line">    &#125;line_number_table[line_number_table_length] &lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;LocalVariableTable&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">    u2 local_variable_table_length;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LocalVariableTable_struct</span>&#123;</span>  </span><br><span class="line">        u2 start_pc;</span><br><span class="line">        u2 length;</span><br><span class="line">        u2 name_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">        u2 descriptor_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">        u2 index;</span><br><span class="line">    &#125;local_variable_table[local_variable_table_length] &lt;comment=attribute_info_LocalVariableTable_OnComment,optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;LocalVariableTypeTable&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">    u2 local_variable_type_table_length;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span>&#123;</span>   </span><br><span class="line">        u2 start_pc;</span><br><span class="line">        u2 length;</span><br><span class="line">        u2 name_index;</span><br><span class="line">        u2 signature_index;</span><br><span class="line">        u2 index;</span><br><span class="line">    &#125;local_variable_type_table[local_variable_type_table_length]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;SourceFile&quot;</span>) </span><br><span class="line"> &#123;</span><br><span class="line">    u2 sourcefile_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;InnerClasses&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u2 number_of_classes;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">InnerClasses_struct</span>&#123;</span></span><br><span class="line">        u2 inner_class_info_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">        u2 outer_class_info_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">        u2 inner_name_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">        u2 inner_class_access_flags&lt;comment=Nested_Class_access_flags_OnComment&gt;;</span><br><span class="line">    &#125;classes[number_of_classes] &lt;comment=attribute_info_InnerClasses_OnComment,optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;EnclosingMethod&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u2 class_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line">    u2 method_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;Signature&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u2 signature_index&lt;comment=Name_OnComment&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;SourceDebugExtension&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u1 debug_extension[attribute_length] &lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;RuntimeVisibleAnnotations&quot;</span>||attribute_name==<span class="string">&quot;RuntimeInvisibleAnnotations&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u2         num_annotations;</span><br><span class="line">    annotation annotations[num_annotations]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;RuntimeVisibleParameterAnnotations&quot;</span>||attribute_name==<span class="string">&quot;RuntimeInvisibleParameterAnnotations&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u1 num_parameters;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span>&#123;</span>   </span><br><span class="line">     u2 num_annotations;</span><br><span class="line">     annotation annotations[num_annotations]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;parameter_annotations[num_parameters]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;AnnotationDefault&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    element_value default_value;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;BootstrapMethods&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u2 num_bootstrap_methods;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span>&#123;</span>   </span><br><span class="line">     u2 bootstrap_method_ref;</span><br><span class="line">     u2 num_bootstrap_arguments;</span><br><span class="line">     u2 bootstrap_arguments[num_bootstrap_arguments]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;bootstrap_methods[num_bootstrap_methods]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">if</span>(attribute_name==<span class="string">&quot;StackMapTable&quot;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    u2 number_of_entries;</span><br><span class="line">    stack_map_frame entries[number_of_entries]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123; </span><br><span class="line">   <span class="keyword">if</span>(attribute_length&gt;<span class="number">0</span>) u1 info[attribute_length] &lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;attribute_info &lt;comment=attribute_info_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    u2             access_flags&lt;comment=Field_access_flags_OnComment&gt;;</span><br><span class="line">    u2             name_index;</span><br><span class="line">    u2             descriptor_index;</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;attributes_count)</span><br><span class="line">    &#123;</span><br><span class="line">     attribute_info attributes[attributes_count] &lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;field_info &lt;comment=field_info_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    u2             access_flags&lt;comment=Method_access_flags_OnComment&gt;;</span><br><span class="line">    u2             name_index;</span><br><span class="line">    u2             descriptor_index;</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;attributes_count)</span><br><span class="line">    &#123;</span><br><span class="line">        attribute_info attributes[attributes_count] &lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;method_info &lt;comment=method_info_OnComment&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">sizeof</span>(this)&gt;<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    u1 tag;</span><br><span class="line">    <span class="keyword">switch</span>(tag) </span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Class:</span><br><span class="line">      u2 name_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Fieldref:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Methodref:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InterfaceMethodref:</span><br><span class="line">      u2 class_index;</span><br><span class="line">      u2 name_and_type_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_String:</span><br><span class="line">      u2 string_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Integer:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Float:</span><br><span class="line">      u4 bytes;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Long:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Double:</span><br><span class="line">       u4 high_bytes&lt;format=hex&gt;;</span><br><span class="line">       u4 low_bytes&lt;format=hex&gt;;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_NameAndType:</span><br><span class="line">      u2 name_index;</span><br><span class="line">      u2 descriptor_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Utf8:</span><br><span class="line">      u2 length;</span><br><span class="line">      <span class="keyword">if</span>(length&gt;<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">       u1 bytes[length]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodHandle:</span><br><span class="line">      u1 reference_kind;</span><br><span class="line">      u2 reference_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodType:</span><br><span class="line">      u2 descriptor_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InvokeDynamic:</span><br><span class="line">      u2 bootstrap_method_attr_index;</span><br><span class="line">      u2 name_and_type_index;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">      Warning(<span class="string">&quot;fix cp_info&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">   &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;cp_info&lt;comment=cp_infoOnComment,size=cp_infoOnSize&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    u4           magic &lt;format=hex&gt;;</span><br><span class="line">    u2           minor_version;</span><br><span class="line">    u2           major_version;</span><br><span class="line">    u2           constant_pool_count;</span><br><span class="line">    cp_info      constant_pool[constant_pool_count<span class="number">-1</span>]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    u2           access_flags &lt;comment=Class_access_flags_OnComment&gt;;</span><br><span class="line">    u2           this_class &lt;comment=Name_OnComment&gt;;</span><br><span class="line">    u2           super_class &lt;comment=Name_OnComment&gt;;</span><br><span class="line"></span><br><span class="line">    u2   interfaces_count;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;interfaces_count)</span><br><span class="line">    &#123; </span><br><span class="line">        u2 interfaces[interfaces_count]&lt;comment=ClassFile_interfaces_OnComment,optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    u2   fields_count;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;fields_count)</span><br><span class="line">    &#123; </span><br><span class="line">        field_info   fields[fields_count]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    u2  methods_count;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;methods_count)</span><br><span class="line">    &#123;</span><br><span class="line">        method_info  methods[methods_count]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    u2           attributes_count;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0</span>&lt;attributes_count)</span><br><span class="line">    &#123;</span><br><span class="line">        attribute_info attributes[attributes_count]&lt;optimize=<span class="literal">false</span>&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;ClassFile&lt;comment=ClassFileOnComment&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//main</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">generator_map_address_constant_pool</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"> local u8 address=address_constant_pool;</span><br><span class="line"> local u1 tag; </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> local <span class="type">int</span> i;</span><br><span class="line"> <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;constant_pool_count; i++)</span><br><span class="line"> &#123;</span><br><span class="line">  map_address_constant_pool[i]=address; </span><br><span class="line"></span><br><span class="line">  tag=ReadUByte(address);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span>(tag) </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Class: <span class="comment">//sizeof(tag)+sizeof(name_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_String: <span class="comment">//sizeof(tag)+sizeof(string_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodType: <span class="comment">//sizeof(tag)+sizeof(descriptor_index)</span></span><br><span class="line">      address=address+<span class="number">3</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Fieldref: <span class="comment">//sizeof(tag)+sizeof(class_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Methodref: <span class="comment">//sizeof(tag)+sizeof(class_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InterfaceMethodref: <span class="comment">//sizeof(tag)+sizeof(class_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_NameAndType: <span class="comment">//sizeof(tag)+sizeof(name_index)+sizeof(descriptor_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InvokeDynamic: <span class="comment">//sizeof(tag)+sizeof(bootstrap_method_attr_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Integer: <span class="comment">//sizeof(tag)+sizeof(bytes)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Float: <span class="comment">//sizeof(tag)+sizeof(bytes)</span></span><br><span class="line">      address=address+<span class="number">5</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Long: <span class="comment">//sizeof(tag)+sizeof(high_bytes)+sizeof(low_bytes)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Double: <span class="comment">//sizeof(tag)+sizeof(high_bytes)+sizeof(low_bytes)</span></span><br><span class="line">      i++;</span><br><span class="line">      map_address_constant_pool[i]=<span class="number">0</span>;</span><br><span class="line">      address=address+<span class="number">9</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Utf8: <span class="comment">//sizeof(tag)+sizeof(length)+length</span></span><br><span class="line">      address=address+<span class="number">3</span>+ReadUShort(address+<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodHandle:<span class="comment">//sizeof(tag)+sizeof(reference_kind)+sizeof(reference_index)</span></span><br><span class="line">      address=address+<span class="number">4</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">      Warning(<span class="string">&quot;fix generator_map_address_constant_pool&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">u8 <span class="title function_">find_constant_pool2</span><span class="params">(u2 n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> map_address_constant_pool[n<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">get_constant_pool_Utf8</span><span class="params">(u2 n)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="string">&quot;NO NAME&quot;</span>;</span><br><span class="line"></span><br><span class="line"> local u8 address=find_constant_pool2(n);</span><br><span class="line"> local u8 address2=<span class="number">0</span>;</span><br><span class="line"> local u8 address3=<span class="number">0</span>;</span><br><span class="line"> local <span class="built_in">string</span> str=<span class="string">&quot;&quot;</span>;</span><br><span class="line"> <span class="keyword">switch</span>(ReadUByte(address)) </span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Class:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_String:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InvokeDynamic:</span><br><span class="line">      address=find_constant_pool2(ReadUShort(address+<span class="number">1</span>)); <span class="comment">//address+sizeof(tag)</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_NameAndType:</span><br><span class="line">       address2=address;</span><br><span class="line">       address=find_constant_pool2(ReadUShort(address+<span class="number">1</span>)); <span class="comment">//address+sizeof(tag)</span></span><br><span class="line">       address2=find_constant_pool2(ReadUShort(address2+<span class="number">3</span>)); <span class="comment">//address+sizeof(tag)+sizeof(name_index)</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Fieldref:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Methodref:</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InterfaceMethodref:</span><br><span class="line">       address2=address;</span><br><span class="line">       address=find_constant_pool2(ReadUShort(address+<span class="number">1</span>)); <span class="comment">//address+sizeof(tag)=class_index</span></span><br><span class="line">       address=find_constant_pool2(ReadUShort(address+<span class="number">1</span>));</span><br><span class="line">       address2=find_constant_pool2(ReadUShort(address2+<span class="number">3</span>)); <span class="comment">//address+sizeof(tag)+sizeof(class_index)=name_and_type_index</span></span><br><span class="line">       address3=address2;</span><br><span class="line">       address2=find_constant_pool2(ReadUShort(address3+<span class="number">1</span>)); <span class="comment">//address+sizeof(tag)=name_index;</span></span><br><span class="line">       address3=find_constant_pool2(ReadUShort(address3+<span class="number">3</span>)); <span class="comment">//address+sizeof(tag)+sizeof(name_index)=descriptor_index</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Integer:</span><br><span class="line">       SPrintf(str, <span class="string">&quot;%d&quot;</span>,ReadUInt(address+<span class="number">1</span>)); </span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Long:</span><br><span class="line">      SPrintf(str, <span class="string">&quot;%Ld&quot;</span>,ReadInt64(address+<span class="number">1</span>)); </span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Float:</span><br><span class="line">       SPrintf(str, <span class="string">&quot;%f&quot;</span>,ReadFloat(address+<span class="number">1</span>)); </span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Double:</span><br><span class="line">       SPrintf(str, <span class="string">&quot;%Lf&quot;</span>,ReadDouble(address+<span class="number">1</span>)); </span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Utf8:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">      Warning(<span class="string">&quot;fix get_constant_pool_Utf8&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;NULL&quot;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(<span class="number">0</span>&lt;Strlen(str))<span class="keyword">return</span> str;</span><br><span class="line">  <span class="keyword">if</span>(address2==<span class="number">0</span>) <span class="keyword">return</span> ReadUShort(address+<span class="number">1</span>)==<span class="number">0</span>?<span class="string">&quot; &quot;</span>:ReadString(address+<span class="number">3</span>,ReadUShort(address+<span class="number">1</span>));</span><br><span class="line">  <span class="keyword">if</span>(address3==<span class="number">0</span>)<span class="keyword">return</span> ReadString(address+<span class="number">3</span>,ReadUShort(address+<span class="number">1</span>))+ReadString(address2+<span class="number">3</span>,ReadUShort(address2+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ReadString(address+<span class="number">3</span>,ReadUShort(address+<span class="number">1</span>))+<span class="string">&quot;.&quot;</span>+ReadString(address2+<span class="number">3</span>,ReadUShort(address2+<span class="number">1</span>))+ReadString(address3+<span class="number">3</span>,ReadUShort(address3+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Access_flags</span><span class="params">(u2 access_flags,enum_type type)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">string</span> access_flags_text;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>((access_flags&amp;ACC_PUBLIC)==ACC_PUBLIC)</span><br><span class="line">  &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;public &quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(type==Field||type==Method||type==Nested_Class)</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_PRIVATE)==ACC_PRIVATE)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;private &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_PROTECTED)==ACC_PROTECTED)</span><br><span class="line">   &#123;</span><br><span class="line">     access_flags_text=access_flags_text+<span class="string">&quot;protected &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_STATIC)==ACC_STATIC)</span><br><span class="line">   &#123;</span><br><span class="line">     access_flags_text=access_flags_text+<span class="string">&quot;static &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span>((access_flags&amp;ACC_FINAL)==ACC_FINAL)</span><br><span class="line">  &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;final &quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(type==Class)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_SUPER_ACC_SYNCHRONIZED)==ACC_SUPER_ACC_SYNCHRONIZED)</span><br><span class="line">   &#123;</span><br><span class="line">     access_flags_text=access_flags_text+<span class="string">&quot;superclass &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(type==Method)</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_SUPER_ACC_SYNCHRONIZED)==ACC_SUPER_ACC_SYNCHRONIZED)</span><br><span class="line">   &#123;</span><br><span class="line">     access_flags_text=access_flags_text+<span class="string">&quot;synchronized &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_BRIDGE_ACC_VOLATILE)==ACC_BRIDGE_ACC_VOLATILE)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;bridge &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_VARARGS_ACC_TRANSIENT)==ACC_VARARGS_ACC_TRANSIENT)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;varargs &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_NATIVE)==ACC_NATIVE)</span><br><span class="line">   &#123;</span><br><span class="line">     access_flags_text=access_flags_text+<span class="string">&quot;native &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_STRICT)==ACC_STRICT)</span><br><span class="line">   &#123;</span><br><span class="line">     access_flags_text=access_flags_text+<span class="string">&quot;strictfp &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(type==Field)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_BRIDGE_ACC_VOLATILE)==ACC_BRIDGE_ACC_VOLATILE)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;volatile &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_VARARGS_ACC_TRANSIENT)==ACC_VARARGS_ACC_TRANSIENT)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;transient &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(type==Class||type==Nested_Class)</span><br><span class="line">  &#123;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_INTERFACE)==ACC_INTERFACE)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;interface &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_ANNOTATION)==ACC_ANNOTATION)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;annotation &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">if</span>(type==Class||type==Method||type==Nested_Class)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>((access_flags&amp;ACC_ABSTRACT)==ACC_ABSTRACT)</span><br><span class="line">    &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;abstract &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>((access_flags&amp;ACC_SYNTHETIC)==ACC_SYNTHETIC)</span><br><span class="line">  &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;synthetic &quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(type==Class||type==Field||type==Nested_Class)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">if</span>((access_flags&amp;ACC_ENUM)==ACC_ENUM)</span><br><span class="line">   &#123;</span><br><span class="line">    access_flags_text=access_flags_text+<span class="string">&quot;enum &quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> access_flags_text;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Event</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">ClassFileOnComment</span><span class="params">(ClassFile &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">string</span> str;</span><br><span class="line">  SPrintf(str, <span class="string">&quot;JVM Byte Code v%d (Java &quot;</span>, obj.major_version);</span><br><span class="line">  <span class="keyword">if</span> (obj.major_version &lt;= <span class="number">43</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    str += <span class="string">&quot;1.0)&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (obj.major_version &lt;= <span class="number">52</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    SPrintf(str, str + <span class="string">&quot;1.%d)&quot;</span>, obj.major_version - <span class="number">44</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    SPrintf(str, str + <span class="string">&quot;%d)&quot;</span>, obj.major_version - <span class="number">44</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">local u1 flag_CONSTANT_Long_CONSTANT_Double=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">u4 <span class="title function_">cp_infoOnSize</span><span class="params">(cp_info &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">switch</span>(ReadUByte(FTell())) </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Class: <span class="comment">//sizeof(tag)+sizeof(name_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_String: <span class="comment">//sizeof(tag)+sizeof(string_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodType: <span class="comment">//sizeof(tag)+sizeof(descriptor_index)</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Fieldref: <span class="comment">//sizeof(tag)+sizeof(class_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Methodref: <span class="comment">//sizeof(tag)+sizeof(class_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InterfaceMethodref: <span class="comment">//sizeof(tag)+sizeof(class_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_NameAndType: <span class="comment">//sizeof(tag)+sizeof(name_index)+sizeof(descriptor_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InvokeDynamic: <span class="comment">//sizeof(tag)+sizeof(bootstrap_method_attr_index)+sizeof(name_and_type_index)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Integer: <span class="comment">//sizeof(tag)+sizeof(bytes)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Float: <span class="comment">//sizeof(tag)+sizeof(bytes)</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Long: <span class="comment">//sizeof(tag)+sizeof(high_bytes)+sizeof(low_bytes)</span></span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Double: <span class="comment">//sizeof(tag)+sizeof(high_bytes)+sizeof(low_bytes)</span></span><br><span class="line">    &#123; </span><br><span class="line">      <span class="keyword">if</span>(flag_CONSTANT_Long_CONSTANT_Double==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        FSkip(<span class="number">-9</span>);</span><br><span class="line">        flag_CONSTANT_Long_CONSTANT_Double=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">9</span>;</span><br><span class="line">   </span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123; </span><br><span class="line">        flag_CONSTANT_Long_CONSTANT_Double=<span class="number">0</span>;</span><br><span class="line">        FSkip(<span class="number">8</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Utf8: <span class="comment">//sizeof(tag)+sizeof(length)+length</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">3</span>+ReadUShort(FTell()+<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodHandle: <span class="comment">//sizeof(tag)+sizeof(reference_kind)+sizeof(reference_index)</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      Warning(<span class="string">&quot;fix cp_infoOnSize&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">cp_infoOnComment</span><span class="params">(cp_info &amp;obj)</span></span><br><span class="line">&#123; </span><br><span class="line">  <span class="comment">//obj.tag</span></span><br><span class="line">  <span class="keyword">switch</span>(ReadUByte(startof(obj))) </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Class:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Class_info&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Fieldref:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Fieldref&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Methodref:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Methodref&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InterfaceMethodref:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_InterfaceMethodref&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_String:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_String&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Integer:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Integer&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Float:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Float&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Long:</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">sizeof</span>(obj)==<span class="number">1</span>)<span class="keyword">return</span> <span class="string">&quot;CONSTANT_Long continued&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Long&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Double:</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">sizeof</span>(obj)==<span class="number">1</span>)<span class="keyword">return</span> <span class="string">&quot;CONSTANT_Double continued&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Double&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_NameAndType:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_NameAndType&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_Utf8:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_Utf8&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodHandle:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_MethodHandle&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_MethodType:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_MethodType&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> CONSTANT_InvokeDynamic:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;CONSTANT_InvokeDynamic&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      Warning(<span class="string">&quot;fix cp_infoOnCommen&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;fix cp_infoOnCommen&quot;</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">ClassFile_interfaces_OnComment</span><span class="params">(u2 interfaces)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(interfaces);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Class_access_flags_OnComment</span><span class="params">(u2 access_flags)</span></span><br><span class="line">&#123; </span><br><span class="line">  <span class="keyword">return</span> Access_flags(access_flags,Class);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Field_access_flags_OnComment</span><span class="params">(u2 access_flags)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> Access_flags(access_flags,Field);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Method_access_flags_OnComment</span><span class="params">(u2 access_flags)</span></span><br><span class="line">&#123; </span><br><span class="line">  <span class="keyword">return</span> Access_flags(access_flags,Method);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Nested_Class_access_flags_OnComment</span><span class="params">(u2 access_flags)</span></span><br><span class="line">&#123; </span><br><span class="line">  <span class="keyword">return</span> Access_flags(access_flags,Nested_Class);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">method_info_OnComment</span><span class="params">(method_info &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(obj.name_index)+get_constant_pool_Utf8(obj.descriptor_index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">field_info_OnComment</span><span class="params">(field_info &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(obj.descriptor_index)+<span class="string">&quot; &quot;</span>+get_constant_pool_Utf8(obj.name_index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">attribute_info_OnComment</span><span class="params">(attribute_info &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(obj.attribute_name_index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">attribute_info_InnerClasses_OnComment</span><span class="params">(InnerClasses_struct &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> get_constant_pool_Utf8(obj.inner_name_index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">attribute_info_LocalVariableTable_OnComment</span><span class="params">(LocalVariableTable_struct &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(obj.name_index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">stack_map_frame_OnComment</span><span class="params">(stack_map_frame &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">if</span>(obj.frame_type&gt;=<span class="number">0</span>&amp;&amp;obj.frame_type&lt;=<span class="number">63</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;same_frame&quot;</span>;  </span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(obj.frame_type&gt;=<span class="number">64</span>&amp;&amp;obj.frame_type&lt;=<span class="number">127</span>)</span><br><span class="line">   &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;same_locals_1_stack_item_frame&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(obj.frame_type==<span class="number">247</span>)</span><br><span class="line">   &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;same_locals_1_stack_item_frame_extended&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(obj.frame_type&gt;=<span class="number">248</span>&amp;&amp;obj.frame_type&lt;=<span class="number">251</span>)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;chop_frame or same_frame_extended&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(obj.frame_type&gt;=<span class="number">252</span>&amp;&amp;obj.frame_type&lt;=<span class="number">254</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;append_frame&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(obj.frame_type==<span class="number">255</span>)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;full_frame&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">annotation_OnComment</span><span class="params">(annotation &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(obj.type_index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Name_OnComment</span><span class="params">(u2 n)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Name_Exception_OnComment</span><span class="params">(u2 n)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">if</span>(n==<span class="number">0</span>)<span class="keyword">return</span> <span class="string">&quot;any&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span> get_constant_pool_Utf8(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">element_value_OnComment</span><span class="params">(element_value &amp;obj)</span></span><br><span class="line">&#123; </span><br><span class="line"> <span class="keyword">switch</span>(obj.tag)</span><br><span class="line"> &#123;   </span><br><span class="line">   <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;String&quot;</span>;</span><br><span class="line">   <span class="keyword">break</span>; </span><br><span class="line">   <span class="keyword">case</span> <span class="string">&#x27;e&#x27;</span>: </span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;enum&quot;</span>;</span><br><span class="line">   <span class="keyword">break</span>; </span><br><span class="line">   <span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>: 	</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;class&quot;</span>;</span><br><span class="line">   <span class="keyword">break</span>; </span><br><span class="line">   <span class="keyword">case</span> <span class="string">&#x27;@&#x27;</span>: 	</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;annotation type&quot;</span>;</span><br><span class="line">   <span class="keyword">break</span>; </span><br><span class="line">   <span class="keyword">case</span> <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;array&quot;</span>;</span><br><span class="line">   <span class="keyword">break</span>; </span><br><span class="line">   <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>; </span><br><span class="line">   <span class="keyword">break</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">opcodes_operation_OnComment</span><span class="params">(opcodes_operation &amp;obj)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">if</span>(!exists(obj.operation))<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">string</span> str;</span><br><span class="line"> <span class="built_in">string</span> str2;</span><br><span class="line"> enum_opcodes obj_operation=obj.operation;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">switch</span>(array_opcodes_body_type[obj.operation])</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">case</span> index_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot; %d&quot;</span>,obj.index);</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> index_v2_body:</span><br><span class="line">     str=<span class="string">&quot; &quot;</span>+get_constant_pool_Utf8(obj.index);</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> index_const_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot; %d&quot;</span>,obj.index);</span><br><span class="line">     SPrintf(str2,<span class="string">&quot; %d&quot;</span>,obj._const);</span><br><span class="line">     str=str+<span class="string">&quot; by&quot;</span>+str2;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> sipush_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot; %d&quot;</span>,obj._byte);</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> bipush_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot; %d&quot;</span>,obj._byte);</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> newarray_body:</span><br><span class="line">      <span class="keyword">switch</span>(obj.atype) </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> T_BOOLEAN:</span><br><span class="line">         str=<span class="string">&quot; boolean&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_CHAR:</span><br><span class="line">         str=<span class="string">&quot; char&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_FLOAT:</span><br><span class="line">         str=<span class="string">&quot; float&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_DOUBLE:</span><br><span class="line">         str=<span class="string">&quot; double&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_BYTE:</span><br><span class="line">         str=<span class="string">&quot; byte&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_SHORT:</span><br><span class="line">         str=<span class="string">&quot; short&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_INT:</span><br><span class="line">         str=<span class="string">&quot; int&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> T_LONG:</span><br><span class="line">         str=<span class="string">&quot; long&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            Warning(<span class="string">&quot;fix opcodes_operation_OnComment&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> multianewarray_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot;%d&quot;</span>,obj.dimensions);</span><br><span class="line">     str=<span class="string">&quot; &quot;</span>+get_constant_pool_Utf8(obj.indexbyte)+<span class="string">&quot; dimensions &quot;</span>+str;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> wide_body:</span><br><span class="line">      enum_opcodes obj_operation2=obj.operation2;</span><br><span class="line">      str=<span class="string">&quot; &quot;</span>+EnumToString(obj_operation2)+get_constant_pool_Utf8(obj.indexbyte);</span><br><span class="line">      <span class="keyword">if</span>(obj_operation2==iinc)</span><br><span class="line">      &#123;</span><br><span class="line">        SPrintf(str2,<span class="string">&quot;%d&quot;</span>,obj.constbyte);</span><br><span class="line">        str=str+<span class="string">&quot; by &quot;</span>+str2;</span><br><span class="line">      &#125;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> tableswitch_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot;%d&quot;</span>,obj.lowbyte);</span><br><span class="line">     SPrintf(str2,<span class="string">&quot;%d&quot;</span>,obj.highbyte);</span><br><span class="line">     str=<span class="string">&quot; &quot;</span>+str+<span class="string">&quot; to &quot;</span>+str2;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> lookupswitch_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot;%d&quot;</span>,obj.npairs);</span><br><span class="line">     str=<span class="string">&quot; &quot;</span>+str;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> invokedynamic_body:</span><br><span class="line">    <span class="keyword">case</span> indexbyte_1_2_body:</span><br><span class="line">     str=<span class="string">&quot; &quot;</span>+get_constant_pool_Utf8(obj.indexbyte);</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> branchbyte1_2_body:</span><br><span class="line">    <span class="keyword">case</span> branchbyte1_4_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot; %d&quot;</span>,obj.branchbyte);</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> invokeinterface_body:</span><br><span class="line">     SPrintf(str,<span class="string">&quot; %d&quot;</span>,obj._count);</span><br><span class="line">     str=<span class="string">&quot; &quot;</span>+get_constant_pool_Utf8(obj.indexbyte)+<span class="string">&quot; count &quot;</span>+str;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> EnumToString(obj_operation)+str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generator_map_address_constant_pool();</span><br><span class="line"></span><br><span class="line">ClassFile classFile;</span><br></pre></td></tr></table></figure>

</div>
        
          <div class="post-copyright">
                  <div class="copyright-item">
                      <span> 作者: Charlott2</span>
                  </div>
                  <div class="copyright-item">
                      <span> 链接: <a href="http://charlott2.github.io/2024/07/27/try-the-template-of-010editor/">http://charlott2.github.io/2024/07/27/try-the-template-of-010editor/</a></span>
                  </div>
                  <div class="copyright-item">
                      <span> 声明: 本博客所有文章除特别声明外，均采用许可协议 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> 转载请注明出处！</span>
                  </div>
          </div>
        
  </div>

  <div class="share-reward">
    <div class="share">
        
<div class="social-share" data-sites="facebook,twitter,wechat,weibo,qq"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css">
<script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script>


      </div>
        <div class="reward">
          
        </div>
    </div>
    
    <div class="post_tags">
      
        <i class="fas fa-tag"></i> <a href="/tags/%E6%B5%85%E5%B0%9D%E8%BE%84%E6%AD%A2/" class="tag">浅尝辄止</a>
      
        <i class="fas fa-tag"></i> <a href="/tags/%E5%B7%A5%E5%85%B7/" class="tag">工具</a>
      
    </div>
    <div class="post-nav">
      
      
    </div>
      




</article>

    
<a id="gotop" href="javascript:" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    






    
<div id="bottom-outer">
    <div id="bottom-inner">
        © 2024 <i class="fa fa-heart" id="heart"></i> Charlott2
        <br>
        Powered by
        <a target="_blank" rel="noopener" href="http://hexo.io">hexo</a> | Theme is <a target="_blank" rel="noopener" href="https://github.com/a2396837/hexo-theme-blank/">blank</a>
        
          <div class="icp-info">
            
          <a href="" target="_blank"> </a>
        </div>
        
    </div>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/layui-src@2.5.5/dist/layui.min.js"></script>



  
    <script src="/js/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
  

 



  <script>
    window.lazyLoadOptions = {
      elements_selector: 'img',
      threshold: 0
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script>   
  


  <script>
    var images = $('img').not('.nav-logo img').not('.card img').not($('a>img')).not('.reward-content img')
    images.each(function (i, o) {
      var lazyloadSrc = $(o).attr('data-src') ? $(o).attr('data-src') : $(o).attr('src')
      $(o).wrap(`<a href="${lazyloadSrc}" data-fancybox="group" data-caption="${$(o).attr('alt')}" class="fancybox"></a>`)
    })
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script>
  <script>
        $().fancybox({
      selector: '[data-fancybox]',
      loop: true,
      transitionEffect: 'slide',
      protect: true,
      buttons: ['slideShow', 'fullScreen', 'thumbs', 'close']
    })
  </script>   
  


  <script>
  if (!window.MathJax) {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]],
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
              const display = !!node.type.match(/; *mode=display/)
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
              const text = document.createTextNode('')
              node.parentNode.replaceChild(text, node)
              math.start = {node: text, delim: '', n: 0}
              math.end = {node: text, delim: '', n: 0}
              doc.math.push(math)
            }
          }, '']
        }
      }
    }
    
    var script = document.createElement('script')
    script.src = "https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"
    script.id = 'MathJax-script'
    script.async = true
    document.head.appendChild(script)
  } else {
    MathJax.startup.document.state(0)
    MathJax.texReset()
    MathJax.typeset()
  }
  </script>
  


  
<script>
if (document.getElementsByClassName('mermaid').length) {
    if (window.mermaidJsLoad) mermaid.init()
    else {
      $.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js", function () {
        window.mermaidJsLoad = true
        mermaid.initialize({
          theme: "default",
        })
      })
    }
  }
  </script>
  






  <script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script>
  


  <script src="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/js/firework.js"></script>
  


  
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script>
<script>
!function (e, t, a) {
  var initCopyCode = function(){
    var copyHtml = '';
    copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
    copyHtml += '  <i class="fa fa-clipboard"></i><span>复制</span>';
    copyHtml += '</button>';
    $(".highlight .code pre").before(copyHtml);
    new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
  }
  initCopyCode();
}(window, document);
</script>  
  

<script>
  var btntop = $('#gotop');
  btntop.on('click', function (e) {
    e.preventDefault();
    $('html, body').animate({ scrollTop: 0 }, '300');
  });

  var $table = $('.content table').not($('figure.highlight > table'))
$table.each(function () {
  $(this).wrap('<div class="table-wrap"></div>')
})
</script>



</html>